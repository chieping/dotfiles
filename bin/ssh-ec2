#!/bin/bash
set -euo pipefail

instance_id=$1
private_ipaddress=$(aws ec2 describe-instances --instance-ids $instance_id | jq -r '.Reservations[0].Instances[0].NetworkInterfaces[0].PrivateIpAddresses[0].PrivateIpAddress')

if [[ ! "$private_ipaddress"z =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}z$ ]]; then
  echo Invalid ipaddress: $private_ipaddress
  exit 1
fi

ssh $private_ipaddress
